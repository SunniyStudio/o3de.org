---
linkTitle: 第28章 Wwise插件
title: 第28章 Wwise插件
description: 第28章 Wwise插件
---
# 第28章 Wwise插件
You'd better wise up, man!
—The Outsiders, 1983
## Introduction
{{<note>}}
Source code for this chapter can be found on GitHub:
https://github.com/AMZN-Olex/O3DEBookCode2111/tree/ch28_wwise_setup
{{</note>}}

This chapter will take a look at adding sound effects to our project. O3DE comes with an integration of Audiokinetic Wwise. However, the installer does not include it, since Wwise is not open-source.

{{<note>}}
Wwise is not a product of O3DE. It is stand-alone product. See its website for full conditions, licensing and details.
http://www.audiokinetic.com/pricing
{{</note>}}

In this chapter we will built a new installation of O3DE with Wwise integration enabled.

## Installing Wwise
1. Navigate to https://www.audiokinetic.com/download/
2. Download the installer for Windows.
3. Install and open Wwise Launcher.
4. Install Wwise 2021 version with "Authoring" and "SDK (C++)" packages.

{{<note>}}
At the time of writing this book, Wwise 2021.1.7.7796 was available and used.
{{</note>}}

{{<note>}}
If you can see environment variable WWISEROOT on the console, then the installation was successful. You may need to re-open a command console (and maybe even reboot your system) to see it after the installation.
C:\git\book\build>set | findstr WWISEROOT
WWISEROOT=D:\Program Files (x86)\
Audiokinetic\Wwise 2021.1.7.7796
During CMake configure step, you should see a message such as:
1>-- Using Wwise SDK at D:\Program Files (x86)\Audiokinetic\Wwise 2021.1.7.7796


You can also test it by adding the following to your gem or project to confirm that CMake sees Wwise installation.
```c++
BUILD_DEPENDENCIES
  PUBLIC
    3rdParty::Wwise
```
{{</note>}}

## Building O3DE Installer with Wwise

{{<note>}}
O3DE pre-built installer that we have used so far does not include Wwise gem.
{{</note>}}

We are going to build a new local O3DE installer with Wwise gem enabled.
1. Clone the repository of O3DE with tag 2111.2 to match the installer we have used so far in the book.
```shell
git clone -b 2111.2 https://github.com/o3de/o3de
```

2. I will assume that the repository was cloned at c:\git\o3de.
3. Create a build folder at c:\git\o3de\build.
4. From the build folder, configure CMake. This should pick up Wwise installation.
```shell
C:\git\o3de\build> cmake -S .. -B .
```

5. Open Visual Studio solution at c:\git\o3de\build\O3DE.sln.
6. Check that there is Gems\AudioEngineWwise present in the solution.
7. Build INSTALL target.

{{<note>}}
This step will take a while, since it builds the entire engine, all the gems and creates a local installation.
{{</note>}}

8. The new engine installation will be placed at c:\git\o3de\install.
9. Open C:\git\o3de\install\engine.json.
10. Modify engine_name and restricted_name to "my-o3de-2111".
11. Configure python in the new engine.
    C:\git\o3de\install> .\python\get_python.bat
12. Register the engine.
    C:\git\o3de\install> .\scripts\o3de.bat register --this-engine
13. Open C:\Users\<user>\.o3de\o3de_manifest.json.
14. Verify that this engine was registered. You should see the following lines.
```json
    {
      ...
      ...
      ...
    }
    "engines": [
      "C:/O3DE/21.11.2",
      "C:/git/o3de/install",
    ],
    "engines_path": {
      "o3de-sdk": "C:/O3DE/21.11.2",
      "my-o3de-2111": "C:/git/o3de/install",

```
15. Switch MyProject to use this new engine by modifying C:\git\book\MyProject\project.json. Change "engine" from "o3de-sdk" to "my-o3de-2111".
```js
    "engine": "my-o3de-2111",
```

16. Re-compile the project.
17. Re-run Asset Processor. (It is going to re-process all the assets.)

{{<tip>}}
    Avoid starting the Editor before all the assets are processed. Crashes may occur before all the     critical assets are ready.
{{</tip>}}

## Setting up a Wwise Project
O3DE pulls audio resources from a collection of audio assets that are called sound banks. These sound banks are generated by a Wwise project. We will create a brand new Wwise project by using Wwise Launcher.

![](/images/learning-guide/tutorials/o3de-book/Part10/o3de_book_10_1.PNG)

Go to WWISE tab and launch Wwise

Initially, you would not have any Wwise projects, so you will need to create a new one.

![](/images/learning-guide/tutorials/o3de-book/Part10/o3de_book_10_2.PNG)

In "New Project" dialog set the following values:
* For Name, enter: wwise_project
* Location: C:\git\book\MyProject\Sounds\
* Original files: "Use default Originals directory"
* Project folder: C:\git\book\MyProject\Sounds\wwise_project

{{<note>}}
There are hidden requirements that O3DE places on Wwise projects.
* The name of the project has to be wwise_project. Always.
* It has to be placed at MyProject\Sounds\wwise_project where MyProject could be any of your projects.
{{</note>}}

Once you create the project you will greeted with Wwise Project Explorer.

![](/images/learning-guide/tutorials/o3de-book/Part10/o3de_book_10_3.PNG)

Wwise application

{{<note>}}
Wwise's job is to generate sound banks for O3DE. However, O3DE expects the banks to be at a specific location, which is different from the default sound bank path set by Wwise. So before we get to adding audio files to the project, configure an important project setting that is vital to get audio working with O3DE. From the main menu, select Project→Project Settings...

Switch to SoundBanks tab

![](/images/learning-guide/tutorials/o3de-book/Part10/o3de_book_10_4.PNG)

We need to change SoundBack Folder path from GeneratedSoundBanks\Generic\ to MyProject\Sounds\wwise. (If wwise folder is not there yet, create it.) When you do that Wwise will adjust the path to make it a relative path. So do not be surprised when it changes to ..\wwise. This is as it ought to be.

![](/images/learning-guide/tutorials/o3de-book/Part10/o3de_book_10_5.PNG)

SoundBank path for O3DE
{{<note>}}

Create a new audio element under Actor-Mixer Hierarchy. Right click on Default Work Unit→ New Child→ Sound SFX.

![](/images/learning-guide/tutorials/o3de-book/Part10/o3de_book_10_6.PNG)

New Child → Sound SFX

Sound SFX is the simplest way to get started with adding audio to a Wwise project. It represents a single audio effect. Rename new sound sfx to Cheer. The next step is to assign it an audio asset by right clicking  on Cheer→Import Audio Files.

![](/images/learning-guide/tutorials/o3de-book/Part10/o3de_book_10_7.PNG)

The importer dialog will show up. Select Add Files... and navigate to applause.wav at C:\git\book\MyProject\Assets\Source Audio\. Click on Import in Audio File Importer dialog.

![](/images/learning-guide/tutorials/o3de-book/Part10/o3de_book_10_8.PNG)

Audio file importer dialog

That will assign the wave file to Cheer. You should see that in Contents Editor.

![](/images/learning-guide/tutorials/o3de-book/Part10/o3de_book_10_9.PNG)

Imported music asset
{{<tip>}}
You can press SPACE while Cheer is selected to test if the sound is the one you wanted and that it actually plays, at least inside Wwise application.
{{</tip>}}

Personally, I found that the applause sound effect was too loud for my taste. So I modified the volume of  this sound element to -8 in Sound Property Editor.

![](/images/learning-guide/tutorials/o3de-book/Part10/o3de_book_10_10.PNG)

Each audio object in Wwise should two events: play and stop. O3DE will manipulate the object through these events. You have to explicitly create them first in Wwise by right clicking on Cheer→ New Event→Play.

![](/images/learning-guide/tutorials/o3de-book/Part10/o3de_book_10_11.PNG)

"Stop" event requires a similar procedure: Cheer→ New Event→ Stop→ Stop. Now, under Event Viewer with Cheer selected, you should see new events.









