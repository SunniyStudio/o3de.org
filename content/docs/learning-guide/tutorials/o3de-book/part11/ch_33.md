---
linkTitle: 第33章 编辑器中的多人游戏
title: 第33章 编辑器中的多人游戏
description: 第33章 编辑器中的多人游戏
---
# 第33章 编辑器中的多人游戏
##  Introduction

{{<note>}}
The accompanying assets for this chapter can be found on GitHub at:
https://github.com/AMZN-Olex/O3DEBookCode2111/tree/ch33_multiplayer_in_editor
{{</note>}}

There are two ways to iterate on multiplayer work, either by launching game launchers directly or using the Editor. MyProject.ServerLauncher with "+host +loadlevel MyLevel" parameters starts the server.

MyProject.GameLauncher with "+connect" parameter starts and connects a client to the local server.

Using the Editor is far easier and faster. This chapter will present the way to use the Editor in the most efficient and fastest method to iterate on a multiplayer game in O3DE.

##  Editor Server
By default, when you press CTRL+G in the Editor multiplayer support is disabled. To enable the multiplayer mode, you have to set a CVar variable editorsv_enabled to true. By default, it is set to false, so in order to avoid having to enable it in the Editor console each time you launch the Editor, we can create a console command file that is loaded automatically by the Editor on launch: C:\git\book\MyProject\editor.cfg.

Example 33.1. Turn on CLTR+G multiplayer with editor.cfg
```
editorsv_enabled=true
editorsv_hidden=true
editorsv_rhi_override=null
```

editorsv_enabled enables the editor server, editorsv_hidden launches the server without a window in the background and editorsv_rhi_override as "null" disables the rendering sub-system. (RHI stands for rendering hardware interface.) Together these are the fastest settings for you to iterate on multiplayer.

{{<tip>}}
If you need to see the server window while working with the Editor, then set editorsv_rhi_override to either "dx12" or "vulkan", depending on your platform, or leave it blank and have it be picked by the Atom renderer.
{{</tip>}}

Procedure 33.1. How to run a multiplayer game in the Editor.
1. Create editor.cfg as described above.
2. Launch the Editor.
3. Enter game mode with CTRL+G.
4. Wait a few seconds for MyProject.ServerLauncher to launch hidden in the background.
5. In a few seconds the Editor will connect as a client to the server in the background.

##  Multiplayer Components in the Level
Now that we know how to test multiplayer in the Editor, where the Editor acts a client, we need to know two important points.
{{<note>}}
All multiplayer components require Net Binding component.
{{</note>}}

![](/images/learning-guide/tutorials/o3de-book/Part11/o3de_book_11_3.PNG)

{{<note>}}
Multiplayer components must not be placed directly into the level. They must be wrapped with a prefab, and then the prefab can be placed into the level.
{{</note>}}

For example, we can create our first multiplayer entity with Transform, Network Binding, My First Network Component, Network Transform Component and a Mesh component.

![](/images/learning-guide/tutorials/o3de-book/Part11/o3de_book_11_4.PNG)

Then in Entity Outliner create a prefab from this entity.

{{<note>}}
Without Network Transform Component, the entity will not appear on clients.
{{</note>}}

![](/images/learning-guide/tutorials/o3de-book/Part11/o3de_book_11_5.PNG)

Figure 33.1. A Network Entity Wrapped in a Prefab

![](/images/learning-guide/tutorials/o3de-book/Part11/o3de_book_11_6.PNG)

This temporarily adds a white box in the middle of our level (Multiplayer_Test.prefab) and when I enter game mode with multiplayer, the white box immediately disappears. This happens because a level prefab is split into two portions: regular and network portion. Regular portion can be spawned immediately but then network portion has to wait until the Editor connects as a client to the server. Then the server will tell the client about all the network entities on the level.

Meanwhile you can confirm that this entity does spawn in the server by looking at the Editor console where it prints the debug lines we added in the previous chapter.
Example 33.2. Editor server log
```
(EditorServer) - MyGem::MyFirstNetworkComponent::OnActivate:
we are on entity Multiplayer Test
MyGem::MyFirstNetworkComponentController::OnActivate:
we are on entity Multiplayer Test
```

## Summary

{{<note>}}
The accompanying assets for this chapter can be found on GitHub at:
https://github.com/AMZN-Olex/O3DEBookCode2111/tree/ch33_multiplayer_in_editor
{{</note>}}

In this chapter we learned how to play a multiplayer game in the Editor and how to place multiplayer entities in the level using prefabs. However, at the moment, none of multiplayer entities appear when entering game mode because our client setup is missing a critical piece without which a network connection between the server and the Editor cannot be established.

We are missing a player object. Once we tell the multiplayer system which entity is our player entity, the connection will be properly established and the development can begin. The next chapter will tackle creation of the simplest player spawner that I could come up with.
